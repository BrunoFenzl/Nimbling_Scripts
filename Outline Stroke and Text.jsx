#target Illustrator#targetengine main//  script.name = Outline Stroke and Text.jsx;//  script.parent = Herman van Boeijen, www.nimbling.com // 07/12/13;//  Big thanks to CarlosCanto and MuppetMark on the Adobe Illustrator Scripting Forums// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -function Outliner(curDoc, selection){	for (i = 0; i < selection.length; i++) {		$.writeln(selection[i]);	    outlineobjecttype = selection[i].typename;		//$.writeln(outlineobjecttype);	    if (outlineobjecttype.indexOf('Text') >= 0) {	    	selection[i].createOutline();	    } else if (outlineobjecttype.indexOf('Path') >= 0) {	    	//$.writeln('Pathitem detected : '+selection[i]);	    	app.executeMenuCommand ('expandStyle');	    }	}}function get_document() {	if (app.documents.length == 0 ) {		Window.alert("You must open at least one document.");		return False;	} else {	    return app.activeDocument;	}}function get_selection(curDoc) {	var sel = curDoc.selection; // get selection	var numselectedobjects = sel.length;	var container = curDoc.activeLayer;	//Only if there are objects selected	if (numselectedobjects == 0) {		alert("No objects selected.");		return False;	} else {		if(container.locked || !container.visible){	        alert("Please select objects on an unlocked and visible layer,\nthen run this script again.");	        return False;	    }	}	return selection;}var curDoc = get_document();var selection = get_selection(curDoc);Outliner(curDoc, selection);