#target Illustrator#targetengine main//  script.name = Clip Retaining Color.jsx;//  script.required = at least two paths selected, top most path is the clipping mask;//  script.parent = Herman van Boeijen, www.nimbling.com // 07/12/13;//  *** LIMITED TO A SINGLE STROKE AND/OR FILL OF THE CLIPPING OBJECT***//  Big thanks to CarlosCanto and MuppetMark on the Adobe Illustrator Scripting Forums// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -function CopyAppearance(clipobject) {    if(clipobject.filled)  {        clipcolors.fillColor = clipobject.fillColor;    }    if(clipobject.stroked) {        clipcolors.stroked = clipobject.stroked;        clipcolors.strokeWidth = clipobject.strokeWidth;        clipcolors.strokeColor = clipobject.strokeColor;    }}//CopyAppearance ENDfunction PasteAppearance(clipobject) {    if(clipcolors.fillColor)    {        clipobject.fillColor = clipcolors.fillColor;    }    if(clipcolors.stroked){        clipobject.stroked = clipcolors.stroked;        clipobject.strokeWidth = clipcolors.strokeWidth;        clipobject.strokeColor = clipcolors.strokeColor;    }}//PasteAppearance ENDfunction ClipRetCol(curDoc){    //IF COMPOUND CLIPPING PATH        if (clipobject.typename === "CompoundPathItem") {            //copy appearance            sel = curDoc.selection;            clipobject = sel[0].pathItems[0];            CopyAppearance(clipobject);                        //MAKEMASK            app.executeMenuCommand ('makeMask');            //Since making the clipping path changed the selection, set variable for selection again            sel = curDoc.selection;            clipobject = sel[0];            clipobject = clipobject.pageItems[0].pathItems[0];            PasteAppearance(clipobject);    }    // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -    //IF REGULAR PATH        else {            //copy appearance            CopyAppearance(clipobject);            //MAKEMASK            app.executeMenuCommand ('makeMask');            //paste appearance            PasteAppearance(clipobject);        }}//ClipRetCol ENDif ( app.documents.length > 0 ) {    var curDoc = app.activeDocument;}else{    Window.alert("You must open at least one document.");}var sel = curDoc.selection; // get selectionvar selectedobjects = sel.length;var clipobject = sel[0]; // the mask is the object on topvar clipcolors = [];var container = curDoc.activeLayer;//Only if there are objects selectedif (selectedobjects){    if(container.locked || !container.visible){        alert("Please select objects on an unlocked and visible layer,\nthen run this script again.");    }else{        ClipRetCol(curDoc);    }}